# Ruff configuration for SynapseML Python code
# https://docs.astral.sh/ruff/configuration/

# Target Python version
target-version = "py311"

# Maximum line length (matches black configuration)
line-length = 120

# Exclude common non-source directories
exclude = [
    ".git",
    ".venv",
    "__pycache__",
    "build",
    "dist",
    "target",
    "*.egg-info",
    ".eggs",
    "node_modules",
]

[lint]
# Start with minimal rules to avoid breaking existing code.
# Enable more rules incrementally after initial fixes.
select = [
    "E",      # pycodestyle errors (critical syntax issues)
    "F",      # Pyflakes (undefined names, unused imports)
]

# Ignore rules that conflict with existing code patterns
ignore = [
    "E501",   # line too long (handled by formatter)
    "E401",   # multiple imports on one line
    "E711",   # comparison to None (existing codebase uses == None)
    "E721",   # do not compare types (existing pattern)
    "E722",   # bare except (existing pattern)
    "F401",   # unused imports (many false positives with __init__.py re-exports)
    "F403",   # star imports (widely used in codebase)
    "F405",   # may be undefined from star imports (consequence of F403)
    "F541",   # f-string without placeholders (harmless)
    "F811",   # redefinition (some intentional patterns)
    "F821",   # undefined name (false positives from dynamic imports)
    "F841",   # local variable assigned but never used
    "E402",   # module level import not at top (some files have setup before imports)
]

# Allow autofix for all enabled rules
fixable = ["ALL"]
unfixable = []

[lint.per-file-ignores]
# Tests can have unused imports (fixtures) and assertions
"**/test_*.py" = ["F401", "B011"]
"**/*_test.py" = ["F401", "B011"]

[lint.isort]
known-first-party = ["synapseml"]
