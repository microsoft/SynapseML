<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-1.0.6 plugin-docs plugin-id-default docs-doc-id-Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Quickstart - Exploring Art Across Cultures | SynapseML</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-rh="true" name="twitter:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.0.6"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.0.6"><meta data-rh="true" name="docsearch:version" content="1.0.6"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.0.6"><meta data-rh="true" property="og:title" content="Quickstart - Exploring Art Across Cultures | SynapseML"><meta data-rh="true" name="description" content="This article serves as a guideline for match-finding via k-nearest-neighbors. You set up code that allows queries involving cultures and mediums of art amassed from the Metropolitan Museum of Art in NYC and the Rijksmuseum in Amsterdam."><meta data-rh="true" property="og:description" content="This article serves as a guideline for match-finding via k-nearest-neighbors. You set up code that allows queries involving cultures and mediums of art amassed from the Metropolitan Museum of Art in NYC and the Rijksmuseum in Amsterdam."><link data-rh="true" rel="icon" href="/SynapseML/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GBW8AA15RD-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/SynapseML/blog/rss.xml" title="SynapseML RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/SynapseML/blog/atom.xml" title="SynapseML Atom Feed">
<link rel="alternate" type="application/json" href="/SynapseML/blog/feed.json" title="SynapseML JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RWPE0183E8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RWPE0183E8",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="SynapseML" href="/SynapseML/opensearch.xml">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/SynapseML/assets/css/styles.2c553299.css">
<link rel="preload" href="/SynapseML/assets/js/runtime~main.a7cb540e.js" as="script">
<link rel="preload" href="/SynapseML/assets/js/main.876959b5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like SynapseML, consider giving it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/Microsoft/SynapseML">GitHub</a> ⭐</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/SynapseML/"><div class="navbar__logo"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SynapseML</b></a><a class="navbar__item navbar__link" href="/SynapseML/docs/Overview/">Docs</a><a class="navbar__item navbar__link" href="/SynapseML/blog/">Blog</a><a class="navbar__item navbar__link" href="/SynapseML/videos/">Videos</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/SynapseML/docs/1.0.6/Overview/">1.0.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/SynapseML/docs/next/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">Next</a></li><li><a class="dropdown__link" href="/SynapseML/docs/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">v1.0.11</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.10/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.10</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.9/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.9</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.8/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.8</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.7/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.7</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.6</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.5/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.5</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.4/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.4</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.3/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.3</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.2/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.2</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.1/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">1.0.1</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.11.4/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">0.11.4</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.11.3/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">0.11.3</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Developer Docs</a><ul class="dropdown__menu"><li><a href="https://mmlspark.blob.core.windows.net/docs/1.0.11/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Python<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://mmlspark.blob.core.windows.net/docs/1.0.11/scala/com/microsoft/azure/synapse/ml/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Scala<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SynapseML/docs/1.0.6/Overview/">What is SynapseML?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.6/Get Started/Create a Spark Cluster/">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/SynapseML/docs/1.0.6/Explore Algorithms/LightGBM/Overview/">Explore Algorithms</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/LightGBM/Overview/">LightGBM</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/AI Services/Overview/">AI Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/OpenAI/Langchain/">OpenAI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Deep Learning/Getting Started/">Deep Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Responsible AI/Interpreting Model Predictions/">Responsible AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Causal Inference/Overview/">Causal Inference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Classification/Quickstart - Train Classifier/">Classification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Regression/Quickstart - Data Cleaning/">Regression</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Anomaly Detection/Quickstart - Isolation Forests/">Anomaly Detection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Hyperparameter Tuning/HyperOpt/">Hyperparameter Tuning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/OpenCV/Image Transformations/">OpenCV</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Vowpal Wabbit/Overview/">Vowpal Wabbit</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Smart Adaptive Recommendations/">Other Algorithms</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Smart Adaptive Recommendations/">SAR Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Cyber ML/">CyberML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Anomalous Access Detection/">Quickstart - Anomalous Access Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">Quickstart - Exploring Art Across Cultures</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.6/Use with MLFlow/Overview/">Use with MLFlow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.6/Deploy Models/Overview/">Deploy Models</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.6/Reference/Contributor Guide/">Reference</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->SynapseML<!-- --> <b>1.0.6</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/SynapseML/docs/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/">latest version</a></b> (<!-- -->v1.0.11<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/SynapseML/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Explore Algorithms</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Other Algorithms</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Quickstart - Exploring Art Across Cultures</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.0.6</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Exploring Art across Culture and Medium with Fast, Conditional, k-Nearest Neighbors</h1><p>This article serves as a guideline for match-finding via k-nearest-neighbors. You set up code that allows queries involving cultures and mediums of art amassed from the Metropolitan Museum of Art in NYC and the Rijksmuseum in Amsterdam.</p><img loading="lazy" src="https://mmlspark.blob.core.windows.net/graphics/art/cross_cultural_matches.jpg" width="600" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview-of-the-balltree">Overview of the BallTree<a href="#overview-of-the-balltree" class="hash-link" aria-label="Direct link to Overview of the BallTree" title="Direct link to Overview of the BallTree">​</a></h2><p>The structure functioning behind the KNN model is a BallTree, which is a recursive binary tree where each node (or &quot;ball&quot;) contains a partition of the points of data to be queried. Building a BallTree involves assigning data points to the &quot;ball&quot; whose center they&#x27;re closest to (with respect to a certain specified feature), resulting in a structure that allows binary-tree-like traversal and lends itself to finding k-nearest neighbors at a BallTree leaf.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup">​</a></h2><p>Import necessary Python libraries and prepare dataset.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">types </span><span class="token keyword">import</span><span class="token plain"> BooleanType</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">types </span><span class="token keyword">import</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">functions </span><span class="token keyword">import</span><span class="token plain"> lit</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> array</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> array_contains</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> udf</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> struct</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">nn </span><span class="token keyword">import</span><span class="token plain"> ConditionalKNN</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> ConditionalKNNModel</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> PIL </span><span class="token keyword">import</span><span class="token plain"> Image</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> io </span><span class="token keyword">import</span><span class="token plain"> BytesIO</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> numpy </span><span class="token keyword">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">pyplot </span><span class="token keyword">as</span><span class="token plain"> plt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Our dataset comes from a table containing artwork information from both the Met and Rijks museums. The schema is as follows:</p><ul><li><strong>id</strong>: A unique identifier for a piece of art<ul><li>Sample Met id: <em>388395</em> </li><li>Sample Rijks id: <em>SK-A-2344</em> </li></ul></li><li><strong>Title</strong>: Art piece title, as written in the museum&#x27;s database</li><li><strong>Artist</strong>: Art piece artist, as written in the museum&#x27;s database</li><li><strong>Thumbnail_Url</strong>: Location of a JPEG thumbnail of the art piece</li><li><strong>Image_Url</strong> Location of an image of the art piece hosted on the Met/Rijks website</li><li><strong>Culture</strong>: Category of culture that the art piece falls under<ul><li>Sample culture categories: <em>latin american</em>, <em>egyptian</em>, etc.</li></ul></li><li><strong>Classification</strong>: Category of medium that the art piece falls under<ul><li>Sample medium categories: <em>woodwork</em>, <em>paintings</em>, etc.</li></ul></li><li><strong>Museum_Page</strong>: Link to the work of art on the Met/Rijks website</li><li><strong>Norm_Features</strong>: Embedding of the art piece image</li><li><strong>Museum</strong>: Specifies which museum the piece originated from</li></ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:rgb(136, 132, 111)"># loads the dataset and the two trained CKNN models for querying by medium and culture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df </span><span class="token operator">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">parquet</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;wasbs://publicwasb@mmlspark.blob.core.windows.net/met_and_rijks.parquet&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">display</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Norm_Features&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-categories-to-be-queried-on">Define categories to be queried on<a href="#define-categories-to-be-queried-on" class="hash-link" aria-label="Direct link to Define categories to be queried on" title="Direct link to Define categories to be queried on">​</a></h2><p>Two KNN models are used: one for culture, and one for medium.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:rgb(136, 132, 111)"># mediums = [&#x27;prints&#x27;, &#x27;drawings&#x27;, &#x27;ceramics&#x27;, &#x27;textiles&#x27;, &#x27;paintings&#x27;, &quot;musical instruments&quot;,&quot;glass&quot;, &#x27;accessories&#x27;, &#x27;photographs&#x27;,  &quot;metalwork&quot;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)">#           &quot;sculptures&quot;, &quot;weapons&quot;, &quot;stone&quot;, &quot;precious&quot;, &quot;paper&quot;, &quot;woodwork&quot;, &quot;leatherwork&quot;, &quot;uncategorized&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">mediums </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;paintings&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;glass&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;ceramics&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)"># cultures = [&#x27;african (general)&#x27;, &#x27;american&#x27;, &#x27;ancient american&#x27;, &#x27;ancient asian&#x27;, &#x27;ancient european&#x27;, &#x27;ancient middle-eastern&#x27;, &#x27;asian (general)&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)">#            &#x27;austrian&#x27;, &#x27;belgian&#x27;, &#x27;british&#x27;, &#x27;chinese&#x27;, &#x27;czech&#x27;, &#x27;dutch&#x27;, &#x27;egyptian&#x27;]#, &#x27;european (general)&#x27;, &#x27;french&#x27;, &#x27;german&#x27;, &#x27;greek&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)">#            &#x27;iranian&#x27;, &#x27;italian&#x27;, &#x27;japanese&#x27;, &#x27;latin american&#x27;, &#x27;middle eastern&#x27;, &#x27;roman&#x27;, &#x27;russian&#x27;, &#x27;south asian&#x27;, &#x27;southeast asian&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)">#            &#x27;spanish&#x27;, &#x27;swiss&#x27;, &#x27;various&#x27;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">cultures </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;japanese&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;american&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;african (general)&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)"># Uncomment the above for more robust and large scale searches!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">classes </span><span class="token operator">=</span><span class="token plain"> cultures </span><span class="token operator">+</span><span class="token plain"> mediums</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">medium_set </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">set</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">mediums</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">culture_set </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">set</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">cultures</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">selected_ids </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">{</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;AK-RBK-17525-2&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;AK-MAK-1204&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;AK-RAK-2015-2-9&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">small_df </span><span class="token operator">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">where</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    udf</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword">lambda</span><span class="token plain"> medium</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> culture</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> id_val</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">medium </span><span class="token keyword">in</span><span class="token plain"> medium_set</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">culture </span><span class="token keyword">in</span><span class="token plain"> culture_set</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">id_val </span><span class="token keyword">in</span><span class="token plain"> selected_ids</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        BooleanType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Classification&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Culture&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">small_df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-and-fit-conditionalknn-models">Define and fit ConditionalKNN models<a href="#define-and-fit-conditionalknn-models" class="hash-link" aria-label="Direct link to Define and fit ConditionalKNN models" title="Direct link to Define and fit ConditionalKNN models">​</a></h2><p>Create ConditionalKNN models for both the medium and culture columns; each model takes in an output column, features column (feature vector), values column (cell values under the output column), and label column (the quality that the respective KNN is conditioned on).</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">medium_cknn </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ConditionalKNN</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setOutputCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Matches&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setFeaturesCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Norm_Features&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setValuesCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Thumbnail_Url&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setLabelCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Classification&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">small_df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">culture_cknn </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ConditionalKNN</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setOutputCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Matches&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setFeaturesCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Norm_Features&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setValuesCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Thumbnail_Url&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setLabelCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Culture&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">small_df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-matching-and-visualizing-methods">Define matching and visualizing methods<a href="#define-matching-and-visualizing-methods" class="hash-link" aria-label="Direct link to Define matching and visualizing methods" title="Direct link to Define matching and visualizing methods">​</a></h2><p>After the initial dataset and category setup, prepare methods that will query and visualize the conditional KNN&#x27;s results.</p><p><code>addMatches()</code> creates a Dataframe with a handful of matches per category.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(166, 226, 46)">add_matches</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">classes</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> cknn</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    results </span><span class="token operator">=</span><span class="token plain"> df</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">for</span><span class="token plain"> label </span><span class="token keyword">in</span><span class="token plain"> classes</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        results </span><span class="token operator">=</span><span class="token plain"> cknn</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            results</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;conditioner&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> array</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">lit</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">label</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">withColumnRenamed</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Matches&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Matches_{}&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token builtin" style="color:rgb(174, 129, 255)">format</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">label</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> results</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>plot_urls()</code> calls <code>plot_img</code> to visualize top matches for each category into a grid.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(166, 226, 46)">plot_img</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">axis</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> title</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">try</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        response </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        img </span><span class="token operator">=</span><span class="token plain"> Image</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token builtin" style="color:rgb(174, 129, 255)">open</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">BytesIO</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">convert</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;RGB&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        axis</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> aspect</span><span class="token operator">=</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;equal&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">except</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> title </span><span class="token keyword">is</span><span class="token plain"> </span><span class="token keyword">not</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        axis</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">set_title</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> fontsize</span><span class="token operator">=</span><span class="token number" style="color:rgb(174, 129, 255)">4</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    axis</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">axis</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;off&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(166, 226, 46)">plot_urls</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">url_arr</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> titles</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    nx</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> ny </span><span class="token operator">=</span><span class="token plain"> url_arr</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">shape</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    plt</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">figure</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">figsize</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">nx </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(174, 129, 255)">5</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> ny </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(174, 129, 255)">5</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> dpi</span><span class="token operator">=</span><span class="token number" style="color:rgb(174, 129, 255)">1600</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    fig</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> axes </span><span class="token operator">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">ny</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> nx</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:rgb(136, 132, 111)"># reshape required in the case of 1 image query</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">len</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">axes</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        axes </span><span class="token operator">=</span><span class="token plain"> axes</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">for</span><span class="token plain"> i </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">range</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">nx</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword">for</span><span class="token plain"> j </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">range</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">ny</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token keyword">if</span><span class="token plain"> j </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                plot_img</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">axes</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">j</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> url_arr</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> j</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> titles</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token keyword">else</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                plot_img</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">axes</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">j</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> url_arr</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> j</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    plt</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">savefig</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> dpi</span><span class="token operator">=</span><span class="token number" style="color:rgb(174, 129, 255)">1600</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(136, 132, 111)"># saves the results as a PNG</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    display</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="putting-it-all-together">Putting it all together<a href="#putting-it-all-together" class="hash-link" aria-label="Direct link to Putting it all together" title="Direct link to Putting it all together">​</a></h2><p>Define <code>test_all()</code> to take in the data, CKNN models, the art id values to query on, and the file path to save the output visualization to. The medium and culture models were previously trained and loaded.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:rgb(136, 132, 111)"># main method to test a particular dataset with two CKNN models and a set of art IDs, saving the result to filename.png</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(166, 226, 46)">test_all</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> cknn_medium</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> cknn_culture</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> test_ids</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> root</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    is_nice_obj </span><span class="token operator">=</span><span class="token plain"> udf</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token keyword">lambda</span><span class="token plain"> obj</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"> obj </span><span class="token keyword">in</span><span class="token plain"> test_ids</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> BooleanType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    test_df </span><span class="token operator">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">where</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">is_nice_obj</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    results_df_medium </span><span class="token operator">=</span><span class="token plain"> add_matches</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">mediums</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> cknn_medium</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> test_df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    results_df_culture </span><span class="token operator">=</span><span class="token plain"> add_matches</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">cultures</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> cknn_culture</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> results_df_medium</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    results </span><span class="token operator">=</span><span class="token plain"> results_df_culture</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    original_urls </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Thumbnail_Url&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"> </span><span class="token keyword">for</span><span class="token plain"> row </span><span class="token keyword">in</span><span class="token plain"> results</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    culture_urls </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Matches_{}&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token builtin" style="color:rgb(174, 129, 255)">format</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">label</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;value&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"> </span><span class="token keyword">for</span><span class="token plain"> row </span><span class="token keyword">in</span><span class="token plain"> results</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword">for</span><span class="token plain"> label </span><span class="token keyword">in</span><span class="token plain"> cultures</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    culture_url_arr </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">original_urls</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> culture_urls</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    plot_urls</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">culture_url_arr</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Original&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> cultures</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> root </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;matches_by_culture.png&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    medium_urls </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Matches_{}&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token builtin" style="color:rgb(174, 129, 255)">format</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">label</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;value&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"> </span><span class="token keyword">for</span><span class="token plain"> row </span><span class="token keyword">in</span><span class="token plain"> results</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword">for</span><span class="token plain"> label </span><span class="token keyword">in</span><span class="token plain"> mediums</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    medium_url_arr </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain">original_urls</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> medium_urls</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    plot_urls</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">medium_url_arr</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Original&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> mediums</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> root </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;matches_by_medium.png&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> results_df_culture</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="demo">Demo<a href="#demo" class="hash-link" aria-label="Direct link to Demo" title="Direct link to Demo">​</a></h2><p>The following cell performs batched queries given desired image IDs and a filename to save the visualization.</p><img loading="lazy" src="https://mmlspark.blob.core.windows.net/graphics/art/cross_cultural_matches.jpg" width="600" class="img_ev3q"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:rgb(136, 132, 111)"># sample query</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">result_df </span><span class="token operator">=</span><span class="token plain"> test_all</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">small_df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> medium_cknn</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> culture_cknn</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> selected_ids</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> root</span><span class="token operator">=</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;.&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/SynapseML/docs/1.0.6/Explore Algorithms/Other Algorithms/Quickstart - Anomalous Access Detection/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quickstart - Anomalous Access Detection</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/SynapseML/docs/1.0.6/Use with MLFlow/Overview/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview-of-the-balltree" class="table-of-contents__link toc-highlight">Overview of the BallTree</a></li><li><a href="#setup" class="table-of-contents__link toc-highlight">Setup</a></li><li><a href="#define-categories-to-be-queried-on" class="table-of-contents__link toc-highlight">Define categories to be queried on</a></li><li><a href="#define-and-fit-conditionalknn-models" class="table-of-contents__link toc-highlight">Define and fit ConditionalKNN models</a></li><li><a href="#define-matching-and-visualizing-methods" class="table-of-contents__link toc-highlight">Define matching and visualizing methods</a></li><li><a href="#putting-it-all-together" class="table-of-contents__link toc-highlight">Putting it all together</a></li><li><a href="#demo" class="table-of-contents__link toc-highlight">Demo</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/Get Started/Install SynapseML/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/Get Started/Quickstart - Your First Models/">Getting Started</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/1.0.11/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python API Reference</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/1.0.11/scala/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scala API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/videos/">Videos</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Microsoft.</div></div></div></footer></div>
<script src="/SynapseML/assets/js/runtime~main.a7cb540e.js"></script>
<script src="/SynapseML/assets/js/main.876959b5.js"></script>
</body>
</html>