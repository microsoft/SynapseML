<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-1.0.2 plugin-docs plugin-id-default docs-doc-id-Use with MLFlow/Overview">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Overview | SynapseML</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-rh="true" name="twitter:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/SynapseML/docs/1.0.2/Use with MLFlow/Overview/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.0.2"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.0.2"><meta data-rh="true" name="docsearch:version" content="1.0.2"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.0.2"><meta data-rh="true" property="og:title" content="Overview | SynapseML"><meta data-rh="true" name="description" content="MLflow support of SynapseML"><meta data-rh="true" property="og:description" content="MLflow support of SynapseML"><link data-rh="true" rel="icon" href="/SynapseML/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/SynapseML/docs/1.0.2/Use with MLFlow/Overview/"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/1.0.2/Use with MLFlow/Overview/" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/1.0.2/Use with MLFlow/Overview/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GBW8AA15RD-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/SynapseML/blog/rss.xml" title="SynapseML RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/SynapseML/blog/atom.xml" title="SynapseML Atom Feed">
<link rel="alternate" type="application/json" href="/SynapseML/blog/feed.json" title="SynapseML JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RWPE0183E8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RWPE0183E8",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="SynapseML" href="/SynapseML/opensearch.xml">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/SynapseML/assets/css/styles.2c553299.css">
<link rel="preload" href="/SynapseML/assets/js/runtime~main.cdeeec07.js" as="script">
<link rel="preload" href="/SynapseML/assets/js/main.a84ef810.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like SynapseML, consider giving it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/Microsoft/SynapseML">GitHub</a> ⭐</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/SynapseML/"><div class="navbar__logo"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SynapseML</b></a><a class="navbar__item navbar__link" href="/SynapseML/docs/Overview/">Docs</a><a class="navbar__item navbar__link" href="/SynapseML/blog/">Blog</a><a class="navbar__item navbar__link" href="/SynapseML/videos/">Videos</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/SynapseML/docs/1.0.2/Overview/">1.0.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/SynapseML/docs/next/Use with MLFlow/Overview/">Next</a></li><li><a class="dropdown__link" href="/SynapseML/docs/Use with MLFlow/Overview/">1.0.15</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.14/Use with MLFlow/Overview/">1.0.14</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.13/Use with MLFlow/Overview/">1.0.13</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.12/Use with MLFlow/Overview/">1.0.12</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.11/Use with MLFlow/Overview/">1.0.11</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.10/Use with MLFlow/Overview/">1.0.10</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.9/Use with MLFlow/Overview/">1.0.9</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.8/Use with MLFlow/Overview/">1.0.8</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.7/Use with MLFlow/Overview/">1.0.7</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.6/Use with MLFlow/Overview/">1.0.6</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.5/Use with MLFlow/Overview/">1.0.5</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.4/Use with MLFlow/Overview/">1.0.4</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.3/Use with MLFlow/Overview/">1.0.3</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/SynapseML/docs/1.0.2/Use with MLFlow/Overview/">1.0.2</a></li><li><a class="dropdown__link" href="/SynapseML/docs/1.0.1/Use with MLFlow/Overview/">1.0.1</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.11.4/Use with MLFlow/Overview/">0.11.4</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.11.3/Use with MLFlow/Overview/">0.11.3</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/SynapseML/docs/1.0.2/Use with MLFlow/Overview/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Developer Docs</a><ul class="dropdown__menu"><li><a href="https://mmlspark.blob.core.windows.net/docs/1.0.15/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Python<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://mmlspark.blob.core.windows.net/docs/1.0.15/scala/com/microsoft/azure/synapse/ml/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Scala<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SynapseML/docs/1.0.2/Overview/">What is SynapseML?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.2/Get Started/Create a Spark Cluster/">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.2/Explore Algorithms/LightGBM/Overview/">Explore Algorithms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/SynapseML/docs/1.0.2/Use with MLFlow/Overview/">Use with MLFlow</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SynapseML/docs/1.0.2/Use with MLFlow/Overview/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/1.0.2/Use with MLFlow/Install/">Install</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/1.0.2/Use with MLFlow/Autologging/">Autologging</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.2/Deploy Models/Overview/">Deploy Models</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SynapseML/docs/1.0.2/Reference/Contributor Guide/">Reference</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->SynapseML<!-- --> <b>1.0.2</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/SynapseML/docs/Use with MLFlow/Overview/">latest version</a></b> (<!-- -->1.0.15<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/SynapseML/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Use with MLFlow</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Overview</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.0.2</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Overview</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-mlflow">What is MLflow<a href="#what-is-mlflow" class="hash-link" aria-label="Direct link to What is MLflow" title="Direct link to What is MLflow">​</a></h2><p><a href="https://github.com/mlflow/mlflow" target="_blank" rel="noopener noreferrer">MLflow</a> is a platform to streamline machine learning development, including tracking experiments, packaging code into reproducible runs, and sharing and deploying models. MLflow offers a set of lightweight APIs that can be used with any existing machine learning application or library, for instance TensorFlow, PyTorch, XGBoost, etc. It runs wherever you currently run ML code, for example, in notebooks, standalone applications or the cloud. MLflow&#x27;s current components are:</p><ul><li><a href="https://mlflow.org/docs/latest/tracking.html" target="_blank" rel="noopener noreferrer">MLflow Tracking</a>: An API to log parameters, code, and results in machine learning experiments and compare them using an interactive UI.</li><li><a href="https://mlflow.org/docs/latest/projects.html" target="_blank" rel="noopener noreferrer">MLflow Projects</a>: A code packaging format for reproducible runs using Conda and Docker, so you can share your ML code with others.</li><li><a href="https://mlflow.org/docs/latest/models.html" target="_blank" rel="noopener noreferrer">MLflow Models</a>: A model packaging format and tools that let you easily deploy the same model from any ML library for both batch and real-time scoring. It supports platforms such as Docker, Apache Spark, Azure ML and AWS SageMaker.</li><li><a href="https://mlflow.org/docs/latest/model-registry.html" target="_blank" rel="noopener noreferrer">MLflow Model Registry</a>: A centralized model store, set of APIs, and UI, to collaboratively manage the full lifecycle of MLflow Models.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h2><p>Install MLflow from PyPI via <code>pip install mlflow</code></p><p>MLflow requires <code>conda</code> to be on the <code>PATH</code> for the projects feature.</p><p>Learn more about MLflow on their <a href="https://github.com/mlflow/mlflow" target="_blank" rel="noopener noreferrer">GitHub page</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-mlflow-on-databricks">Install Mlflow on Databricks<a href="#install-mlflow-on-databricks" class="hash-link" aria-label="Direct link to Install Mlflow on Databricks" title="Direct link to Install Mlflow on Databricks">​</a></h3><p>If you&#x27;re using Databricks, install Mlflow with this command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># run this so that Mlflow is installed on workers besides driver</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">%pip install mlflow</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-mlflow-on-synapse">Install Mlflow on Synapse<a href="#install-mlflow-on-synapse" class="hash-link" aria-label="Direct link to Install Mlflow on Synapse" title="Direct link to Install Mlflow on Synapse">​</a></h3><p>To log model with Mlflow, you need to create an Azure Machine Learning workspace and link it with your Synapse workspace.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-azure-machine-learning-workspace">Create Azure Machine Learning Workspace<a href="#create-azure-machine-learning-workspace" class="hash-link" aria-label="Direct link to Create Azure Machine Learning Workspace" title="Direct link to Create Azure Machine Learning Workspace">​</a></h4><p>Follow this document to create <a href="https://learn.microsoft.com/en-us/azure/machine-learning/quickstart-create-resources#create-the-workspace" target="_blank" rel="noopener noreferrer">AML workspace</a>. You don&#x27;t need to create compute instance and compute clusters.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-an-azure-ml-linked-service">Create an Azure ML Linked Service<a href="#create-an-azure-ml-linked-service" class="hash-link" aria-label="Direct link to Create an Azure ML Linked Service" title="Direct link to Create an Azure ML Linked Service">​</a></h4><img loading="lazy" src="https://mmlspark.blob.core.windows.net/graphics/Documentation/ml_linked_service_1.png" width="600" class="img_ev3q"><ul><li>In the Synapse workspace, go to <strong>Manage</strong> -&gt; <strong>External connections</strong> -&gt; <strong>Linked services</strong>, select <strong>+ New</strong></li><li>Select the workspace you want to log the model in and create the linked service. You need the <strong>name of the linked service</strong> to set up connection.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="auth-synapse-workspace">Auth Synapse Workspace<a href="#auth-synapse-workspace" class="hash-link" aria-label="Direct link to Auth Synapse Workspace" title="Direct link to Auth Synapse Workspace">​</a></h4><img loading="lazy" src="https://mmlspark.blob.core.windows.net/graphics/Documentation/ml_linked_service_2.png" width="600" class="img_ev3q"><ul><li>Go to the <strong>Azure Machine Learning workspace</strong> resource -&gt; <strong>access control (IAM)</strong> -&gt; <strong>Role assignment</strong>, select <strong>+ Add</strong>, choose <strong>Add role assignment</strong></li><li>Choose <strong>contributor</strong>, select next</li><li>In members page, choose <strong>Managed identity</strong>, select  <strong>+ select members</strong>. Under <strong>managed identity</strong>, choose Synapse workspace. Under <strong>Select</strong>, choose the workspace you run your experiment on. Click <strong>Select</strong>, <strong>Review + assign</strong>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="use-mlflow-in-synapse-with-linked-service">Use MLFlow in Synapse with Linked Service<a href="#use-mlflow-in-synapse-with-linked-service" class="hash-link" aria-label="Direct link to Use MLFlow in Synapse with Linked Service" title="Direct link to Use MLFlow in Synapse with Linked Service">​</a></h4><p>Set up connection</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)">#AML workspace authentication using linked service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> notebookutils</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">mssparkutils </span><span class="token keyword">import</span><span class="token plain"> azureML</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">linked_service_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;YourLinkedServiceName&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">ws </span><span class="token operator">=</span><span class="token plain"> azureML</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">getWorkspace</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">linked_service_name</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">set_tracking_uri</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">ws</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">get_mlflow_tracking_uri</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)">#Set MLflow experiment. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">experiment_name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;synapse-mlflow-experiment&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">set_experiment</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">experiment_name</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="use-mlflow-in-synapse-without-a-linked-service">Use MLFlow in Synapse without a Linked Service<a href="#use-mlflow-in-synapse-without-a-linked-service" class="hash-link" aria-label="Direct link to Use MLFlow in Synapse without a Linked Service" title="Direct link to Use MLFlow in Synapse without a Linked Service">​</a></h4><p>Once you create an AML workspace, you can obtain the MLflow tracking URL directly. The AML start page is where you can locate the MLflow tracking URL.</p><img loading="lazy" src="https://mmlspark.blob.core.windows.net/graphics/Documentation/mlflow_tracking_url.png" width="600" class="img_ev3q">You can set it tracking url with ```python mlflow.set_tracking_uri(&quot;your mlflow tracking url&quot;) ```<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mlflow-api-reference">MLFlow API Reference<a href="#mlflow-api-reference" class="hash-link" aria-label="Direct link to MLFlow API Reference" title="Direct link to MLFlow API Reference">​</a></h2><ul><li><a href="https://www.mlflow.org/docs/latest/python_api/mlflow.spark.html#mlflow.spark.save_model" target="_blank" rel="noopener noreferrer">mlflow.spark.save_model</a></li><li><a href="https://www.mlflow.org/docs/latest/python_api/mlflow.spark.html#mlflow.spark.log_model" target="_blank" rel="noopener noreferrer">mlflow.spark.log_model</a></li><li><a href="https://www.mlflow.org/docs/latest/python_api/mlflow.spark.html#mlflow.spark.load_model" target="_blank" rel="noopener noreferrer">mlflow.spark.load_model</a></li><li><a href="https://mlflow.org/docs/latest/python_api/mlflow.html#mlflow.log_metric" target="_blank" rel="noopener noreferrer">mlflow.log_metric</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lightgbmclassifier">LightGBMClassifier<a href="#lightgbmclassifier" class="hash-link" aria-label="Direct link to LightGBMClassifier" title="Direct link to LightGBMClassifier">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">import</span><span class="token plain"> mlflow</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">featurize </span><span class="token keyword">import</span><span class="token plain"> Featurize</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">lightgbm </span><span class="token keyword">import</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">train </span><span class="token keyword">import</span><span class="token plain"> ComputeModelStatistics</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    feature_columns </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Number of times pregnant&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Plasma glucose concentration a 2 hours in an oral glucose tolerance test&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Diastolic blood pressure (mm Hg)&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Triceps skin fold thickness (mm)&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;2-Hour serum insulin (mu U/ml)&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Body mass index (weight in kg/(height in m)^2)&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Diabetes pedigree function&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;Age (years)&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    df </span><span class="token operator">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">131</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">66</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">40</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">34.3</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.196</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">22</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">7</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">194</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">68</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">28</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">35.9</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.745</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">41</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">3</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">139</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">54</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">25.6</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.402</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">22</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">6</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">134</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">70</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">23</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">130</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">35.4</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.542</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">29</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">9</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">124</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">70</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">33</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">402</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">35.4</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.282</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">34</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">93</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">100</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">39</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">72</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">43.4</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1.021</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">35</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">4</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">110</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">76</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">20</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">100</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">28.4</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.118</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">27</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">2</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">127</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">58</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">24</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">275</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">27.7</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1.6</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">25</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">104</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">64</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">37</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">64</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">33.6</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.51</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">22</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">2</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">120</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">54</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">26.8</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.455</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">27</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">7</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">178</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">84</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">39.9</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.331</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">41</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">2</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">88</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">58</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">26</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">16</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">28.4</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.766</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">22</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">91</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">64</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">24</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">29.2</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.192</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">21</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">10</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">101</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">76</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">48</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">180</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">32.9</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.171</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">63</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">5</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">73</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">60</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">26.8</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.268</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">27</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">3</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">158</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">70</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">30</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">328</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">35.5</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.344</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">35</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">2</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">105</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">75</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">23.3</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.56</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">53</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">12</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">84</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">72</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">31</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">29.7</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.297</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">46</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">9</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">119</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">80</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">35</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">29.0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.263</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">29</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">6</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">93</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">50</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">30</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">64</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">28.7</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.356</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">23</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">126</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">60</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">30.1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">0.349</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">47</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token number" style="color:rgb(174, 129, 255)">1</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> feature_columns</span><span class="token operator">+</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;labels&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">repartition</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">2</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    featurize </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">Featurize</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setOutputCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;features&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setInputCols</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">feature_columns</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setOneHotEncodeCategoricals</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setNumFeatures</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">4096</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    df_trans </span><span class="token operator">=</span><span class="token plain"> featurize</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    lightgbm_classifier </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">LightGBMClassifier</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setFeaturesCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;features&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setRawPredictionCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;rawPrediction&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setDefaultListenPort</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">12402</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setNumLeaves</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">5</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setNumIterations</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">10</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setObjective</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;binary&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setLabelCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;labels&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setLeafPredictionCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;leafPrediction&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setFeaturesShapCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;featuresShap&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    lightgbm_model </span><span class="token operator">=</span><span class="token plain"> lightgbm_classifier</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df_trans</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:rgb(136, 132, 111)"># Use mlflow.spark.save_model to save the model to your path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">save_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">lightgbm_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;lightgbm_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:rgb(136, 132, 111)"># Use mlflow.spark.log_model to log the model if you have a connected mlflow service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">log_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">lightgbm_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;lightgbm_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:rgb(136, 132, 111)"># Use mlflow.pyfunc.load_model to load model back as PyFuncModel and apply predict</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    prediction </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">pyfunc</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">load_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;lightgbm_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df_trans</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">toPandas</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    prediction </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">list</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token builtin" style="color:rgb(174, 129, 255)">map</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token builtin" style="color:rgb(174, 129, 255)">str</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> prediction</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">log_param</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;prediction&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">prediction</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:rgb(136, 132, 111)"># Use mlflow.spark.load_model to load model back as PipelineModel and apply transform</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    predictions </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">load_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;lightgbm_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df_trans</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    metrics </span><span class="token operator">=</span><span class="token plain"> ComputeModelStatistics</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">evaluationMetric</span><span class="token operator">=</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;classification&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> labelCol</span><span class="token operator">=</span><span class="token string" style="color:rgb(230, 219, 116)">&#x27;labels&#x27;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> scoredLabelsCol</span><span class="token operator">=</span><span class="token string" style="color:rgb(230, 219, 116)">&#x27;prediction&#x27;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">predictions</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">log_metric</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;accuracy&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> metrics</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token number" style="color:rgb(174, 129, 255)">0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&#x27;accuracy&#x27;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-ai-services">Azure AI Services<a href="#azure-ai-services" class="hash-link" aria-label="Direct link to Azure AI Services" title="Direct link to Azure AI Services">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">import</span><span class="token plain"> mlflow</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">services </span><span class="token keyword">import</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    text_key </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;YOUR_COG_SERVICE_SUBSCRIPTION_KEY&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    df </span><span class="token operator">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">createDataFrame</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;I am so happy today, its sunny!&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;en-US&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;I am frustrated by this rush hour traffic&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;en-US&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;The cognitive services on spark aint bad&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;en-US&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;text&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;language&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    sentiment_model </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">TextSentiment</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setSubscriptionKey</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">text_key</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setLocation</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;eastus&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setTextCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;text&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setOutputCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;prediction&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setErrorCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;error&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setLanguageCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;language&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    display</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">sentiment_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">save_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">sentiment_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;sentiment_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">log_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">sentiment_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;sentiment_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    output_df </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">load_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;sentiment_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    display</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">output_df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:rgb(136, 132, 111)"># In order to call the predict function successfully you need to specify the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:rgb(136, 132, 111)"># outputCol name as `prediction`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    prediction </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">pyfunc</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">load_model</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;sentiment_model&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">toPandas</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    prediction </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">list</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token builtin" style="color:rgb(174, 129, 255)">map</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token builtin" style="color:rgb(174, 129, 255)">str</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> prediction</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">log_param</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;prediction&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;,&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">prediction</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/SynapseML/docs/1.0.2/Explore Algorithms/Other Algorithms/Quickstart - Exploring Art Across Cultures/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quickstart - Exploring Art Across Cultures</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/SynapseML/docs/1.0.2/Use with MLFlow/Install/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Install</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-mlflow" class="table-of-contents__link toc-highlight">What is MLflow</a></li><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a><ul><li><a href="#install-mlflow-on-databricks" class="table-of-contents__link toc-highlight">Install Mlflow on Databricks</a></li><li><a href="#install-mlflow-on-synapse" class="table-of-contents__link toc-highlight">Install Mlflow on Synapse</a></li></ul></li><li><a href="#mlflow-api-reference" class="table-of-contents__link toc-highlight">MLFlow API Reference</a></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a><ul><li><a href="#lightgbmclassifier" class="table-of-contents__link toc-highlight">LightGBMClassifier</a></li><li><a href="#azure-ai-services" class="table-of-contents__link toc-highlight">Azure AI Services</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/Get Started/Install SynapseML/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/Get Started/Quickstart - Your First Models/">Getting Started</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/1.0.13/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python API Reference</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/1.0.15/scala/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scala API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/videos/">Videos</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Microsoft.</div></div></div></footer></div>
<script src="/SynapseML/assets/js/runtime~main.cdeeec07.js"></script>
<script src="/SynapseML/assets/js/main.a84ef810.js"></script>
</body>
</html>